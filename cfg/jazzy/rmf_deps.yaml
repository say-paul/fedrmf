# RMF Dependencies Configuration
# Similar to rosfed's catkin.yaml for dependency resolution
# Format follows rosfed patterns for compatibility

# Global configuration
global:
  ros_distro: jazzy
  fedora_version: 39
  architecture: x86_64
  
# ROS package name mappings
# Maps ROS package names to Fedora package names
ros_packages:
  # Core ROS 2 packages
  ament_cmake: ros-{distro}-ament-cmake
  ament_cmake_auto: ros-{distro}-ament-cmake-auto
  ament_cmake_gtest: ros-{distro}-ament-cmake-gtest
  ament_cmake_pytest: ros-{distro}-ament-cmake-pytest
  ament_cmake_python: ros-{distro}-ament-cmake-python
  ament_cmake_ros: ros-{distro}-ament-cmake-ros
  ament_index_cpp: ros-{distro}-ament-index-cpp
  ament_index_python: ros-{distro}-ament-index-python
  ament_lint_auto: ros-{distro}-ament-lint-auto
  ament_lint_common: ros-{distro}-ament-lint-common
  
  # ROS 2 core libraries
  rclcpp: ros-{distro}-rclcpp
  rclcpp_action: ros-{distro}-rclcpp-action
  rclcpp_components: ros-{distro}-rclcpp-components
  rclcpp_lifecycle: ros-{distro}-rclcpp-lifecycle
  rclpy: ros-{distro}-rclpy
  rcutils: ros-{distro}-rcutils
  rmw: ros-{distro}-rmw
  rmw_implementation: ros-{distro}-rmw-implementation
  rmw_fastrtps_cpp: ros-{distro}-rmw-fastrtps-cpp
  rmw_cyclonedx_cpp: ros-{distro}-rmw-cyclonedx-cpp
  
  # Message packages
  builtin_interfaces: ros-{distro}-builtin-interfaces
  geometry_msgs: ros-{distro}-geometry-msgs
  nav_msgs: ros-{distro}-nav-msgs
  sensor_msgs: ros-{distro}-sensor-msgs
  std_msgs: ros-{distro}-std-msgs
  std_srvs: ros-{distro}-std-srvs
  action_msgs: ros-{distro}-action-msgs
  lifecycle_msgs: ros-{distro}-lifecycle-msgs
  
  # TF and transformations
  tf2: ros-{distro}-tf2
  tf2_ros: ros-{distro}-tf2-ros
  tf2_geometry_msgs: ros-{distro}-tf2-geometry-msgs
  tf2_eigen: ros-{distro}-tf2-eigen
  tf2_kdl: ros-{distro}-tf2-kdl
  
  # Robot description and URDF
  urdf: ros-{distro}-urdf
  urdf_parser_plugin: ros-{distro}-urdf-parser-plugin
  xacro: ros-{distro}-xacro
  robot_state_publisher: ros-{distro}-robot-state-publisher
  joint_state_publisher: ros-{distro}-joint-state-publisher
  joint_state_publisher_gui: ros-{distro}-joint-state-publisher-gui
  
  # Gazebo integration
  gazebo_ros: ros-{distro}-gazebo-ros
  gazebo_plugins: ros-{distro}-gazebo-plugins
  gazebo_msgs: ros-{distro}-gazebo-msgs
  gazebo_ros_pkgs: ros-{distro}-gazebo-ros-pkgs
  
  # Navigation stack
  nav2_common: ros-{distro}-nav2-common
  nav2_core: ros-{distro}-nav2-core
  nav2_msgs: ros-{distro}-nav2-msgs
  nav2_util: ros-{distro}-nav2-util
  navigation2: ros-{distro}-navigation2
  
  # Visualization
  rviz2: ros-{distro}-rviz2
  rviz_common: ros-{distro}-rviz-common
  rviz_default_plugins: ros-{distro}-rviz-default-plugins
  
  # Testing frameworks
  gtest_vendor: ros-{distro}-gtest-vendor
  gmock_vendor: ros-{distro}-gmock-vendor
  
  # Python bindings
  pybind11_vendor: ros-{distro}-pybind11-vendor
  python_cmake_module: ros-{distro}-python-cmake-module

# System dependencies mapping
# Maps system library names to Fedora package names
system_dependencies:
  # Build tools
  cmake: cmake
  make: make
  gcc: gcc
  g++: gcc-c++
  pkg-config: pkgconfig
  autotools: autotools
  
  # Math and computation libraries
  eigen3: eigen3-devel
  blas: openblas-devel
  lapack: lapack-devel
  gsl: gsl-devel
  fftw: fftw-devel
  
  # Boost libraries
  boost: boost-devel
  boost-system: boost-system
  boost-filesystem: boost-filesystem
  boost-program-options: boost-program-options
  boost-thread: boost-thread
  boost-date-time: boost-date-time
  
  # Serialization and data formats
  yaml-cpp: yaml-cpp-devel
  nlohmann_json: json-devel
  tinyxml: tinyxml-devel
  tinyxml2: tinyxml2-devel
  pugixml: pugixml-devel
  jsoncpp: jsoncpp-devel
  protobuf: protobuf-devel
  
  # Graphics and visualization
  opencv: opencv-devel
  pcl: pcl-devel
  vtk: vtk-devel
  opengl: mesa-libGL-devel
  glew: glew-devel
  freeglut: freeglut-devel
  
  # Qt libraries
  qt5: qt5-qtbase-devel
  qt5-widgets: qt5-qtbase-devel
  qt5-core: qt5-qtbase-devel
  qt5-gui: qt5-qtbase-devel
  qt5-opengl: qt5-qtopengl-devel
  qt5-svg: qt5-qtsvg-devel
  qt5-xml: qt5-qtxml-devel
  
  # Networking and communication
  openssl: openssl-devel
  curl: libcurl-devel
  zeromq: zeromq-devel
  websocketpp: websocketpp-devel
  poco: poco-devel
  
  # Database
  sqlite3: sqlite-devel
  postgresql: postgresql-devel
  mysql: mysql-devel
  
  # Image and media processing
  ffmpeg: ffmpeg-devel
  gstreamer: gstreamer1-devel
  gstreamer-plugins-base: gstreamer1-plugins-base-devel
  
  # Python dependencies
  python3: python3
  python3-dev: python3-devel
  python3-numpy: python3-numpy
  python3-scipy: python3-scipy
  python3-matplotlib: python3-matplotlib
  python3-yaml: python3-yaml
  python3-lxml: python3-lxml
  python3-requests: python3-requests
  
  # Python bindings
  pybind11: pybind11-devel
  sip: sip
  pyqt5: python3-qt5
  
  # Documentation tools
  doxygen: doxygen
  sphinx: python3-sphinx
  graphviz: graphviz
  
  # Version control
  git: git
  subversion: subversion
  mercurial: mercurial

# RMF-specific package mappings
rmf_packages:
  # Core RMF packages
  rmf_utils: ros-{distro}-rmf-utils
  rmf_traffic: ros-{distro}-rmf-traffic
  rmf_task: ros-{distro}-rmf-task
  rmf_battery: ros-{distro}-rmf-battery
  rmf_ros2: ros-{distro}-rmf-ros2
  
  # RMF message packages
  rmf_api_msgs: ros-{distro}-rmf-api-msgs
  rmf_building_map_msgs: ros-{distro}-rmf-building-map-msgs
  rmf_charger_msgs: ros-{distro}-rmf-charger-msgs
  rmf_dispenser_msgs: ros-{distro}-rmf-dispenser-msgs
  rmf_door_msgs: ros-{distro}-rmf-door-msgs
  rmf_fleet_msgs: ros-{distro}-rmf-fleet-msgs
  rmf_ingestor_msgs: ros-{distro}-rmf-ingestor-msgs
  rmf_internal_msgs: ros-{distro}-rmf-internal-msgs
  rmf_lift_msgs: ros-{distro}-rmf-lift-msgs
  rmf_task_msgs: ros-{distro}-rmf-task-msgs
  rmf_traffic_msgs: ros-{distro}-rmf-traffic-msgs
  rmf_visualization_msgs: ros-{distro}-rmf-visualization-msgs
  rmf_workcell_msgs: ros-{distro}-rmf-workcell-msgs
  
  # RMF tools and utilities
  rmf_traffic_editor: ros-{distro}-rmf-traffic-editor
  rmf_visualization: ros-{distro}-rmf-visualization
  rmf_simulation: ros-{distro}-rmf-simulation
  
  # RMF vendor packages
  menge_vendor: ros-{distro}-menge-vendor
  nlohmann_json_schema_validator_vendor: ros-{distro}-nlohmann-json-schema-validator-vendor
  pybind11_json_vendor: ros-{distro}-pybind11-json-vendor
  
  # RMF demonstration packages
  rmf_demos: ros-{distro}-rmf-demos
  rmf_demos_assets: ros-{distro}-rmf-demos-assets
  rmf_demos_dashboard_resources: ros-{distro}-rmf-demos-dashboard-resources
  rmf_demos_gz: ros-{distro}-rmf-demos-gz
  rmf_demos_maps: ros-{distro}-rmf-demos-maps
  rmf_demos_panel: ros-{distro}-rmf-demos-panel
  rmf_demos_tasks: ros-{distro}-rmf-demos-tasks

# Package overrides for special cases
# These packages need special handling
package_overrides:
  rmf_traffic_editor:
    additional_build_deps:
      - qt5-qtbase-devel
      - qt5-qtsvg-devel
      - qt5-qtopengl-devel
      - opencv-devel
      - yaml-cpp-devel
    additional_runtime_deps:
      - qt5-qtbase
      - qt5-qtsvg
      - qt5-qtopengl
      - opencv
      - yaml-cpp
    cmake_args:
      - "-DBUILD_TESTING=OFF"
      - "-DCMAKE_BUILD_TYPE=RelWithDebInfo"
      
  rmf_visualization:
    additional_build_deps:
      - qt5-qtbase-devel
      - qt5-qtwidgets-devel
      - qt5-qtsvg-devel
    additional_runtime_deps:
      - qt5-qtbase
      - qt5-qtwidgets
      - qt5-qtsvg
      
  rmf_simulation:
    additional_build_deps:
      - gazebo-devel
      - sdformat-devel
      - ignition-transport-devel
    additional_runtime_deps:
      - gazebo
      - sdformat
      - ignition-transport
      
  menge_vendor:
    additional_build_deps:
      - cmake
      - gcc-c++
      - tinyxml-devel
    cmake_args:
      - "-DBUILD_TESTING=OFF"
      - "-DCMAKE_BUILD_TYPE=RelWithDebInfo"
      
  nlohmann_json_schema_validator_vendor:
    additional_build_deps:
      - json-devel
      - cmake
    cmake_args:
      - "-DBUILD_TESTING=OFF"

# Packages to skip during build
skip_packages:
  - rmf_demos_panel  # May have Qt/GUI issues in headless builds
  - rmf_demos_dashboard_resources  # Web resources, not needed for core functionality

# Build dependencies that should be added to all packages
global_build_dependencies:
  - cmake
  - gcc-c++
  - pkgconfig
  - ros-{distro}-ament-cmake

# Runtime dependencies that should be added to all packages
global_runtime_dependencies:
  - ros-{distro}-rclcpp

# License mappings for spec file generation
license_mappings:
  "Apache License 2.0": Apache-2.0
  "Apache-2.0": Apache-2.0
  "Apache 2.0": Apache-2.0
  "MIT": MIT
  "BSD": BSD
  "BSD-3-Clause": BSD
  "GPL": GPL
  "LGPL": LGPL

# Build flags and configurations
build_config:
  cmake_flags:
    default:
      - "-DCMAKE_BUILD_TYPE=RelWithDebInfo"
      - "-DBUILD_TESTING=OFF"
      - "-DCMAKE_INSTALL_PREFIX=/opt/ros/{distro}"
    
    with_network:
      - "-DFETCHCONTENT_FULLY_DISCONNECTED=OFF"
      - "-DFETCHCONTENT_TRY_FIND_PACKAGE_MODE=NEVER"
    
    debug:
      - "-DCMAKE_BUILD_TYPE=Debug"
      - "-DBUILD_TESTING=ON"
      
  parallel_jobs: 4
  
  rpm_macros:
    - "%global ros_distro {distro}"
    - "%global _enable_debug_package 0"
    - "%global debug_package %{nil}"

# Dependency resolution rules
dependency_rules:
  # Rules for resolving ambiguous dependencies
  prefer_vendor_packages: true
  ignore_test_dependencies: true
  
  # Dependency substitutions
  substitutions:
    "python3-pytest": "python3-pytest"
    "python3-colcon-common-extensions": "python3-colcon-common-extensions"
    
  # Packages that should not be treated as dependencies
  ignore_packages:
    - "python3-setuptools"  # Usually available in base system
    - "python3-pip"         # Not needed for RPM builds

# Repository configuration
repositories:
  primary:
    - "https://download.fedoraproject.org/pub/fedora/linux/releases/{fedora_version}/Everything/{arch}/os/"
    - "https://download.fedoraproject.org/pub/fedora/linux/updates/{fedora_version}/Everything/{arch}/"
  
  copr:
    ros: "@robotics-sig/ros2"
    rmf: "user/rmf-packages" 